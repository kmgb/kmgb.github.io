<!doctypehtml><html lang=en><meta charset=utf-8><title>Web Automation - Kevin Brennan</title><meta content="My exploration of web automation using JavaScript, Playwright, and AutoHotkey."name=description><meta content=width=device-width,initial-scale=1.0 name=viewport><link href=/resources/style.css rel=stylesheet><script defer src=/resources/scripts/site.js></script><link href=/resources/images/favicon.svg rel=icon type=image/svg+xml><link href=/resources/images/favicon.png rel=icon type=image/png><body><div class=layout-grid><header><div class=header-inner><div class=header-left><a href=/ title=Home><svg viewbox="0 0 65.723 71.094"height=32 role=img width=32 xmlns=http://www.w3.org/2000/svg><title>Home</title><g fill=currentColor fill-rule=nonzero font-size=9pt stroke=currentColor stroke-linecap=round stroke-width=0.25mm style=stroke:currentColor;stroke-width:.25mm;fill:currentColor><path d="M 25.537 71.094 L 0 71.094 L 0 64.941 L 7.959 63.574 L 7.959 7.568 L 0 6.201 L 0 0 L 25.537 0 L 25.537 6.201 L 17.578 7.568 L 17.578 63.574 L 25.537 64.941 L 25.537 71.094 Z M 56.494 7.422 L 16.895 50.537 L 11.768 44.58 L 45.508 7.129 L 45.703 6.885 L 40.381 6.201 L 40.381 0 L 63.184 0 L 63.184 6.201 L 56.494 7.422 Z M 65.723 71.094 L 41.992 71.094 L 41.992 64.941 L 47.852 64.258 L 47.803 64.209 L 28.125 36.914 L 33.496 29.346 L 59.18 63.721 L 65.723 64.941 L 65.723 71.094 Z"vector-effect=non-scaling-stroke></path></g></svg></a><a title="GitHub profile"href=https://github.com/kmgb><svg viewbox="0 0 496 512"fill=currentColor fill-rule=evenodd height=32 role=img stroke=none width=32 xmlns=http://www.w3.org/2000/svg><title>GitHub profile</title><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></div><nav class=site-nav><ul><li><a href=/blog>Blog</a><li><a href=/resume>Resumé</a><li><a href=/text-analysis>Text analysis</a><li><a href=/browser-extensions>Browser extensions</a></ul></nav></div></header><script>var clickExampleButton=(a=>{alert(a.isTrusted?`You clicked the button!`:`You used JavaScript to click the button!`)})</script><main><article><h1>Web Automation</h1><p>Web automation refers to automating interactions with websites. This can be done for a variety of reasons, such as testing a website, scraping data from a website, or automating a task that would otherwise be tedious to do by hand. My exploration of web automation will explore JavaScript, Playwright, and AutoHotkey. I will discuss each method and the advantages and disadvantages of each, with a particular focus on detectability.<p>Detectability is important to discuss in the current age of web technology, where automation is fought more and more by detection scripts like reCaptcha v3 and Cloudflare bot detection, among others. For good reason, too. No website owner wants their website to be scraped by bots and have their work made irrelevant by other websites reposting their content or fed into large language models. There are, however, still moral, smaller-scale applications of automation, and having working methods is important.<section><h2>JavaScript</h2><p>One of the easiest ways to get into web automation is simply using JavaScript in the browser. This can be done using your browser's developer console or using a JavaScript-injection extension (<a href=https://github.com/violentmonkey/violentmonkey>Violentmonkey</a> works on both Firefox and Chrome and is open-source.) This method covers the majority of use-cases.<p>As a very easy example, try clicking the button below and observe the result.</p><button id=example-button onclick=clickExampleButton(event) type=button>Click me</button><p>Now, try doing the same thing with JavaScript by entering the developer console (<kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>I</kbd> on Chrome or <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>K</kbd> on Firefox), and type the following:<pre class=cpp><code>document.querySelector('#example-button').click()</code></pre><p>Both clicking the button above and using JavaScript to click the button will result in an alert. However, the message is different when using JavaScript. This is because websites can easily distinguish whether an action was performed by a user or by JavaScript. The technical details for this detection are as follows: when a user performs an action, an <code>Event</code> object is generated and passed to event handlers. This object contains an immutable property set by the browser called <code>isTrusted</code>, which is <code>true</code> when the event was generated by a user and <code>false</code> when the event was generated by JavaScript. So a website (and bot protection script) need only check whether <code>event.isTrusted === false</code> to see if an action was performed by JavaScript.</section><section><h2>Playwright/Puppeteer/Selenium</h2><p><a href=https://playwright.dev/>Playwright</a> is a library used for creating and controlling browser instances (Chrome, Firefox, Edge or Safari) for the purpose of test automation. Other similar libraries include <a href=https://pptr.dev/>Puppeteer</a> (which only supports Chrome) and <a href=https://www.selenium.dev/>Selenium</a> (which has been around much longer). All of these libraries are similar and have the same fundamental advantages and disadvantages.<p>These libraries work by creating a browser instance and then allowing you to send commands to the browser. These commands include navigating to a URL, clicking an element, querying for information on a webpage, typing text, etc. One advantage over plain JavaScript is that the <code>Event.isTrusted</code> property is set to true for any events generated. This avoids that very trivial detection method.<p>There are, however, other ways to detect automation from these libraries. This includes a numerous list of JavaScript APIs that are modified in the browser instance, User-Agent strings, and the existence of extra global JavaScript variables created by the libraries for their functionality. For that reason, there are packages like playwright-stealth, puppeteer-extra-plugin-stealth and selenium-stealth, which attempt to hide these discrepancies from normal browsers. However, these packages are not perfect at hiding the numerous differences and are not necessarily kept up to date.</section><section><h2>AutoHotkey</h2><p><a href=https://www.autohotkey.com/>AutoHotkey</a> is an automation scripting language for Windows capable of automating many operating system tasks like keyboard and mouse actions. It is very powerful and can be used for a variety of tasks, including web automation. All you need is to use a normal browser and create an AutoHotkey script capable of interacting with the web content through keyboard and mouse commands.<p>While AutoHotkey is not purpose-built for web automation, it's possible to query for the browser window position and size, take a screenshot, then use <code>ImageSearch</code> to look for coordinates of a particular part of the page. This gives you the ability to interact with elements on the page given how they look.<p>This is notably less convenient than using JavaScript or a purpose-built web automation library because you can't directly query for elements, but it has the advantage of not being nearly as detectable by the website. It uses the same browser as a normal user, and the <code>Event.isTrusted</code> value is true because as far as the browser is concerned, the user is performing the actions. The only way to detect this is to observe mouse movements or typing speed to determine if a bot is performing the actions, but this can also be mitigated by slightly randomizing movements and timing and making typing speed more realistic.</section><section><h2>Conclusion</h2><p>There are many ways to automate web tasks, and each has its own advantages and disadvantages. JavaScript is the easiest to get started with, but is also the most detectable. Playwright/Puppeteer/Selenium are more difficult to get started with, but are slightly less detectable, especially with precautions. AutoHotkey is the most difficult to get started with, but is the least detectable with only mouse and keyboard interactions to monitor.<p>In general, I would recommend JavaScript for most tasks like userscripts for improving website functionality while you're using it. For actual testing of your own websites or automation on websites that don't employ bot detection, Playwright/Puppeteer/Selenium are good options because of their convenience and programming language bindings, which are useful for actually processing the data from the automation. For automation on websites that employ bot detection, AutoHotkey is the best option because of its low detectability when the correct precautions are taken.</section></article></main><footer><div class=footer-inner><span class=footer-left>© 2024 Kevin Brennan</span><span class=footer-right><input id=theme-checkbox type=checkbox><label for=theme-checkbox>Website theme</label></span></div></footer></div>